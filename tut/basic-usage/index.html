<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://subpatch.net/tut/basic-usage/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Basic usage - subpatch</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Basic usage";
        var mkdocs_page_input_path = "tut/basic-usage.md";
        var mkdocs_page_url = "/tut/basic-usage/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> subpatch
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Explanations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../exp/intro/">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../exp/history/">Pre-subpatch history</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../exp/design/">subpatch design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../exp/comparison/">Comparison to other tools</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Basic usage</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cloning-the-example-repository">Cloning the example repository</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#optional-buliding-the-c-project">(optional) Buliding the C project</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#adding-the-third-party-dependency">Adding the third party dependency</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#optional-enable-and-build-the-tests">(optional) Enable and build the tests</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#congratulations">Congratulations</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref/glossary/">Glossary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref/releases/">Releases</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../imprint/">Imprint</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">subpatch</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Tutorials</li>
      <li class="breadcrumb-item active">Basic usage</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="basic-usage">Basic usage</h1>
<p>This tutorial explains how to add a third party dependency with subpatch to a
git repository.</p>
<p>In this tutorial the superproject is a simple C-library project that contains a
function that adds two numbers. The subproject (=third party dependency) is the
<a href="https://google.github.io/googletest/">GoogleTest</a> test library for C and C++
projects.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>To follow the tutorial you need the following setup</p>
<ul>
<li>Basic knowledge of git and the command line</li>
<li>git installed</li>
<li>subpatch installed (See <a href="../installation/">Installation</a> for the details)</li>
<li>(optional) cmake and a c/c++ compiler installed</li>
</ul>
<h2 id="cloning-the-example-repository">Cloning the example repository</h2>
<p>First you need to clone the
<a href="https://github.com/lengfeld/subpatch-example0">example repository</a>. It's
the superproject that contains minimal C library. On the command line execute</p>
<pre><code>$ git clone https://github.com/lengfeld/subpatch-example0
$ cd subpatch-example0
</code></pre>
<p>If interested, have a look at the <code>README.md</code> file.</p>
<h2 id="optional-buliding-the-c-project">(optional) Buliding the C project</h2>
<p>If you want, you can also build the C library and test the example program.
You need cmake and a c/c++ compiler for that. Execute the commands</p>
<pre><code>$ cmake -B build .
$ cmake --build build
$ build/prog 9 7
16
</code></pre>
<h2 id="adding-the-third-party-dependency">Adding the third party dependency</h2>
<p>The example project contains the file <code>test.cc</code>. It is currently unused,
because the GoogleTest dependency is missing. You will add it shortly.</p>
<p>As a good practice you should add all third party dependencies in a subfolder
called <code>external</code>. To add the dependency execute the commands</p>
<pre><code>$ mkdir external
$ cd external
$ subpatch add https://github.com/google/googletest
</code></pre>
<p>The last command takes some seconds to execute. It downloads the git repository
and extract the files. It uses the default branch of the git repository. In
most cases this is the <code>main</code> or the <code>master</code> branch. If you want to download
another branch or tag, you must use an additional argument (<em>NOTE:</em> this
argument is not implemented yet).</p>
<p>When the command finishes it prints the message</p>
<pre><code>Adding subproject 'googletest' was successful.
- To inspect the changes, use `git status` and `git diff --staged`.
- If you want to keep the changes, commit them with `git commit`.
- If you want to revert the changes, execute 'git reset --merge`.
</code></pre>
<p>The message contains three different options. To see what subpatch added
to the git index, execute</p>
<pre><code>$ git status
</code></pre>
<p>There are around 240 new files. Commit them by executing</p>
<pre><code>$ cd ..
$ git commit -m "external: Adding GooglTest dependency"
</code></pre>
<p><em>Info</em>: Apart from the files of the third party dependency subpatch also
adds some metadata to the superproject. You can find it a the root
directory of the git repository in the file <code>.subpatch</code>. For this
tutorial the content looks like</p>
<pre><code>[subpatch "external/googletest"]
    url = https://github.com/google/googletest
</code></pre>
<h2 id="optional-enable-and-build-the-tests">(optional) Enable and build the tests</h2>
<p>After adding the GoogleTest dependency, you can build and execute the tests.
Open the <code>CMakeLists.txt</code> file and enable them. You can find the needed cmake
configuration already in the file, just remove the comments. Now the last lines
of the file should look like</p>
<pre><code># Tests
add_subdirectory(external/googletest.git gtest)
add_executable(test test.cc)
target_link_libraries(test GTest::gtest_main add)
include(GoogleTest)
gtest_discover_tests(test)
</code></pre>
<p>After that you can build and run the tests with</p>
<pre><code>$ cmake --build build
$ build/test
</code></pre>
<p>Executing the last command will perform all tests and show the test results. All
tests should pass!</p>
<h2 id="congratulations">Congratulations</h2>
<p>Congratulations! You have added your first subproject with subpatch.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../installation/" class="btn btn-neutral float-left" title="Installation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../ref/glossary/" class="btn btn-neutral float-right" title="Glossary">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../installation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../ref/glossary/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
