<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://subpatch.net/exp/intro/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Introduction - subpatch</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Introduction";
        var mkdocs_page_input_path = "exp/intro.md";
        var mkdocs_page_url = "/exp/intro/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script>
    <script>
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init be ys Ss me gs ws capture Ne calculateEventProperties xs register register_once register_for_session unregister unregister_for_session Rs getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty Is ks createPersonProfile Ps bs opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing $s debug Es getPageViewId captureTraceFeedback captureTraceMetric".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
        posthog.init('phc_chUAcZwaWKpnTf7BKG3taQVBVo1lxKQMML3la6Z9eSE', {
            api_host: 'https://eu.i.posthog.com',
            defaults: '2025-05-24',
            persistence: 'memory',
            person_profiles: 'identified_only', // or 'always' to create profiles for anonymous users as well
        })
    </script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> subpatch
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Explanations</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Introduction</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#example-1-cc-library-as-source-dependency">Example 1: C/C++ library as source dependency</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-2-embedded-linux-firmware-based-on-yocto">Example 2: Embedded Linux firmware based on Yocto</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#recap">Recap</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learnings/">Learnings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../requirements/">Requirements</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../comparison/">Comparison to other tools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../benefits/">Benefits and drawbacks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../faq/">Frequently asked questions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../design/">Design decisions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../impl/">Implementation details</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tut/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tut/basic-usage/">Basic usage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tut/applying-patches/">Applying patches</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">How-to guides</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../howto/yocto/">Project based on Yocto</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref/command-line/">Command line arguments</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref/format/">Format</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref/glossary/">Glossary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref/releases/">Releases</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref/froscon25/">FrOSCon 25</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref/fosdem25/">FOSDEM 25</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../imprint/">Imprint</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">subpatch</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Explanations</li>
      <li class="breadcrumb-item active">Introduction</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="introduction">Introduction</h1>
<p>Welcome to the realm of multi repository management and third-party source
dependencies. Even if you are an experienced software developer, you may not
have encountered this issue in your career already.  It only arises when
working on larger software projects, managing inter-team software dependencies,
or in the field of embedded software engineering.</p>
<p>This page explains the issue with two examples:</p>
<ul>
<li>Example 1: C/C++ library as source dependency</li>
<li>Example 2: multi repository project for linux embedded firmware</li>
</ul>
<h2 id="example-1-cc-library-as-source-dependency">Example 1: C/C++ library as source dependency</h2>
<p>This example illustrates a third party source dependency.</p>
<p>I maintain a small C/C++ library called
<a href="https://github.com/lengfeld/aminilog">aminilog</a>. It's useful when writing
C/C++ code in an Android Application project that uses the
<a href="https://developer.android.com/ndk/">Android NDK</a>
(Native Development toolkit). The library provides ready to use logging macros,
because the NDK only contains the low level APIs for logging.</p>
<p>I publish the library as a plain git repository. Since it is really
simple, there are no release tarballs or tags and no binary artifacts. Also
binary artifacts would do not make sense, because all of the library content
are C/C++ macros that must be evaluated at compile time.</p>
<p>In 2023 I prepared a talk about the
<a href="https://www.youtube.com/watch?v=NKP4JcVegbY">Glass-To-Glass-Latency in Android</a>.
For my latency experiments I created a git repository and needed the above
mentioned C/C++ library as a source dependency.  I develop an Android
Application that could perform various tests and experiments. The code of the
application is on github in the repo
<a href="https://github.com/inovex/android-glass-to-glass-latency/">inovex/android-glass-to-glass-latency</a>.</p>
<p>In this application I also used the Android NDK to write some C++ code to
access some libc functions from Java and to trigger the torch light of the
Pixel2 phone as fast as possible.  And while written and testing the C++ code I
needed to write some log messages.  Therefore I imported my aminilog library as
a source dependency into the project. The commands were roughly the following:</p>
<pre><code>$ mkdir external/
$ cd external/
$ git clone https://github.com/lengfeld/aminilog.git
$ rm -rf aminilog/.git
$ git add aminilog/
$ git commit -m "add aminilog dependency"
</code></pre>
<p>And then I integrated the library into the cmake build systems by adding the line</p>
<pre><code>add_subdirectory(../../../../pixeltorch pixeltorch)
[...]
target_link_libraries(${PROJECT_NAME} android [...] aminilog)
</code></pre>
<p>into the <code>CMakeLists.txt</code>.</p>
<p>That was all. I added the source files of the <a href="https://github.com/lengfeld/aminilog">aminilog</a>
library as files to the git repository
<a href="https://github.com/inovex/android-glass-to-glass-latency/">android-glass-to-glass-latency</a>
and integrated them to the cmake build system.
In this example the git repository <em>android-glass-to-glass-latency</em> is the
superproject and the source dependency <em>aminilog</em> is the subproject.</p>
<h2 id="example-2-embedded-linux-firmware-based-on-yocto">Example 2: Embedded Linux firmware based on Yocto</h2>
<p>This example illustrates a multi repository setup of a Yocto project.
The <a href="https://yoctoproject.org">Yocto project</a> is a build system to build
a Linux embedded distribution and firmware. It's based on OpenEmbedded.</p>
<p>The core consists of</p>
<ul>
<li>bitbake (recipe parser and build orchestration)</li>
<li>meta-oecore (base recipes and toolchain)</li>
<li>documentation</li>
<li>the poky distro</li>
</ul>
<p>All of this is bundled in the <a href="https://git.yoctoproject.org/poky/">poky repository</a>.
Poky is often used as a based for embedded Linux firmware projects, but you can
also add the different components separately.</p>
<p>Furthermore the Yocto project has the concept of layers. These are git repositories
by external parties that contains additional recipes, bbappends, machines and
distros. These add additional hardware support, software and other features.
E.g. <a href="https://github.com/meta-qt5/meta-qt5">meta-qt</a>
adds support for the QT graphics framework and
<a href="https://git.yoctoproject.org/meta-raspberrypi/about/">meta-raspperypi</a> adds
support for the RaspberryPI hardware.</p>
<p>In general building an embedded firmware with Yocto consists of using poky and
2 or more additional external layers. And mostly also maintaining your own
layer with build configurations, additional patches and recipes for your own
applications.</p>
<p>As a developer you would clone multiple repositories . An
example:</p>
<pre><code>$ git clone https://git.yoctoproject.org/poky
$ git clone git://git.openembedded.org/meta-openembedded
$ git clone https://git.yoctoproject.org/meta-raspberrypi
</code></pre>
<p>Then you would configure the build and add the layers.</p>
<pre><code>$ . poky/oe-init-build-env
$ vim conf/bblayers.conf
$ vim conf/local.conf
$ bitbake some-image
</code></pre>
<p>Then adding our own layer for your modifications:</p>
<pre><code>$ bitbake-layers create-layer ../meta-mylayer
$ cd ../meta-mylayer
$ git init
# e.g. add an image recipe
$ git commit -m "add image reipce"
</code></pre>
<p>And finally you start the build</p>
<pre><code>$ bitbake my-image
</code></pre>
<p>and use the firmware files in the build artifacts to flash your device.</p>
<p>This is also an example of a <em>multi repository management</em> problem.  To make a
firmware build for the device you, a coworker and the continuous integration
pipeline needs to clone four different repositories, namely</p>
<ul>
<li>poky,</li>
<li>meta-openembedded,</li>
<li>meta-raspperypi and</li>
<li>meta-mylayer.</li>
</ul>
<p>The first three repos are maintained by external parties. The last repo is
maintained by you.</p>
<p>Since everyone is facing the multi repository problem when working on Yocto
projects, there are already some attempts to handle it. E.g. some use
<a href="https://gerrit.googlesource.com/git-repo/+/HEAD/README.md">repo</a> or
<a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">git submodules</a>
as generic solutions to the multi repository problem.  But
there is also the <a href="https://kas.readthedocs.io/en/latest/intro.html">kas</a>
project.  It allows to checkout multi external git repos and provides a lot
additional feature for maintaining Yocto projects. E.g. to assemble the
<code>local.conf</code> and <code>bblayers.conf</code> dynamically.</p>
<h2 id="recap">Recap</h2>
<p>The two examples show the multi repository problem. Now you can continue
reading my <a href="../learnings/">learnings and history</a> of the past years dealing with
this problem.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../.." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../learnings/" class="btn btn-neutral float-right" title="Learnings">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright © 2024-2025 Stefan Lengfeld (This website is licensed under CC BY-SA 4.0)</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../.." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../learnings/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
